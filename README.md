# 基于selenium的公交站点爬虫脚本

## **概要**

此爬虫脚本主要基于自动化测试库selenium进行实现。selenium是一个自动化测试工具，本质上是通过驱动浏览器，完全模拟浏览器的操作，比如跳转、输入、点击、下拉等进而拿到网页渲染之后的结果，可支持多种浏览器。此脚本通过selenium模拟浏览器操作的特性来实现长三角41个城市的公交站点的爬取

## **脚本特点**

### **优点**

优点是可以帮我们避开一系列复杂的通信流程，绕过网站反爬策略的成本较低。

### **缺点**

由于selenium本质上是驱动浏览器对目标站点发送请求，需要等待页面的加载与渲染，所以用它的坏处就是效率极低！

综合上述优缺点，如果在另外一份针对静态网页的爬虫脚本完全能胜任爬取任务时，建议优先使用静态网页爬虫；如果在某段时间网页渲染机制发生变化或增加反爬策略导致另一份脚本无法胜任时，可以在速度上退而求其次，采用针对动态网页的爬虫脚本进行采集任务。

## 环境部署

Python 版本3.7及以上

selenium 版本3及以上

Chrome 建议使用版本 97.0.4692.71（正式版本） （64 位）

chromedriver 版本同Chrome浏览器

## 操作说明

直接运行脚本，会跳出Chrome浏览器进行自动化的驱动。其间**一定一定要注意！不能最小化浏览器！不能最小化浏览器**！否则CSS的加载以及js的动态渲染有可能受到影响，导致爬取数据的缺失。

## 输出说明

完成脚本后会在当前文件夹下生成“results”子文件夹，并且将生成的结果（嵌套字典）保存为json文件“bus_stops.json”放置于此文件夹下，主要格式为：

```python
{"省名":
	{
        "城市名":
            {
				"py":(该城市对应的拼音),
                "bus_stop":[...,...,...](字符串列表记录公交站点名)
            },
        "城市名":
            {
				"py":(该城市对应的拼音),
                "bus_stop":[...,...,...](字符串列表记录公交站点名)
            },
        ...
    },
 "省名":
	{
        "城市名":
            {
				"py":(该城市对应的拼音),
                "bus_stop":[...,...,...](字符串列表记录公交站点名)
            },
        "城市名":
            {
				"py":(该城市对应的拼音),
                "bus_stop":[...,...,...](字符串列表记录公交站点名)
            },
        ...
    },
 ...
}
```

**由于进行一次完整爬取的时间较长**，如有疑问可以直接查看已生成的**json文件**，不需要再运行脚本，以方便后期输出格式调整工作的进行。<u>在知晓输出格式后，请在`main()`函数中将文件输出函数`save2json()`注释掉。</u>
